========================================
cutileGPT Nsight Systems Profiling
========================================

Running nsys profile...
Uninstalled 1 package in 0.57ms
Installed 1 package in 6ms
================================================================================
cutileGPT Performance Profiling
================================================================================
Mode: nsys
CuPy version: 13.6.0
CUDA version: 13000
GPU: NVIDIA GB10
Compute Capability: 121
================================================================================

================================================================================
System-Wide Profile (for use with nsys)
================================================================================

Running benchmark...
  Batch: 8, Seq Len: 128
  Model: 8 layers, 256 dims

Executing 20 forward passes...
  Progress: 5/20
  Progress: 10/20
  Progress: 15/20
  Progress: 20/20

Benchmark completed!

Use nsys to see timeline and GPU utilization:
  nsys profile -o profile --stats=true python profile_performance.py --tool nsys
Generating '/tmp/nsys-report-9589.qdstrm'
[1/8] [0%                          ] cutile_nsys.nsys-rep[1/8] [0%                          ] cutile_nsys.nsys-rep[1/8] [9%                          ] cutile_nsys.nsys-rep[1/8] [10%                         ] cutile_nsys.nsys-rep[1/8] [=========43%                ] cutile_nsys.nsys-rep[1/8] [=========44%                ] cutile_nsys.nsys-rep[1/8] [=========45%                ] cutile_nsys.nsys-rep[1/8] [==========47%               ] cutile_nsys.nsys-rep[1/8] [==========48%               ] cutile_nsys.nsys-rep[1/8] [==========49%               ] cutile_nsys.nsys-rep[1/8] [===========50%              ] cutile_nsys.nsys-rep[1/8] [===========51%              ] cutile_nsys.nsys-rep[1/8] [===========52%              ] cutile_nsys.nsys-rep[1/8] [===========53%              ] cutile_nsys.nsys-rep[1/8] [============54%             ] cutile_nsys.nsys-rep[1/8] [============55%             ] cutile_nsys.nsys-rep[1/8] [============56%             ] cutile_nsys.nsys-rep[1/8] [============57%             ] cutile_nsys.nsys-rep[1/8] [=============58%            ] cutile_nsys.nsys-rep[1/8] [=============59%            ] cutile_nsys.nsys-rep[1/8] [=============60%            ] cutile_nsys.nsys-rep[1/8] [==============61%           ] cutile_nsys.nsys-rep[1/8] [==============62%           ] cutile_nsys.nsys-rep[1/8] [==============63%           ] cutile_nsys.nsys-rep[1/8] [===============65%          ] cutile_nsys.nsys-rep[1/8] [===============66%          ] cutile_nsys.nsys-rep[1/8] [================69%         ] cutile_nsys.nsys-rep[1/8] [==================76%       ] cutile_nsys.nsys-rep[1/8] [====================83%     ] cutile_nsys.nsys-rep[1/8] [====================84%     ] cutile_nsys.nsys-rep[1/8] [========================100%] cutile_nsys.nsys-rep[1/8] [========================100%] cutile_nsys.nsys-rep[1/8] [========================100%] cutile_nsys.nsys-rep
[2/8] [0%                          ] cutile_nsys.sqlite[2/8] [1%                          ] cutile_nsys.sqlite[2/8] [2%                          ] cutile_nsys.sqlite[2/8] [3%                          ] cutile_nsys.sqlite[2/8] [4%                          ] cutile_nsys.sqlite[2/8] [5%                          ] cutile_nsys.sqlite[2/8] [6%                          ] cutile_nsys.sqlite[2/8] [7%                          ] cutile_nsys.sqlite[2/8] [8%                          ] cutile_nsys.sqlite[2/8] [9%                          ] cutile_nsys.sqlite[2/8] [10%                         ] cutile_nsys.sqlite[2/8] [11%                         ] cutile_nsys.sqlite[2/8] [12%                         ] cutile_nsys.sqlite[2/8] [13%                         ] cutile_nsys.sqlite[2/8] [14%                         ] cutile_nsys.sqlite[2/8] [=15%                        ] cutile_nsys.sqlite[2/8] [=16%                        ] cutile_nsys.sqlite[2/8] [=17%                        ] cutile_nsys.sqlite[2/8] [==18%                       ] cutile_nsys.sqlite[2/8] [==19%                       ] cutile_nsys.sqlite[2/8] [==20%                       ] cutile_nsys.sqlite[2/8] [==21%                       ] cutile_nsys.sqlite[2/8] [===22%                      ] cutile_nsys.sqlite[2/8] [===23%                      ] cutile_nsys.sqlite[2/8] [===24%                      ] cutile_nsys.sqlite[2/8] [====25%                     ] cutile_nsys.sqlite[2/8] [====26%                     ] cutile_nsys.sqlite[2/8] [====27%                     ] cutile_nsys.sqlite[2/8] [====28%                     ] cutile_nsys.sqlite[2/8] [=====29%                    ] cutile_nsys.sqlite[2/8] [=====30%                    ] cutile_nsys.sqlite[2/8] [=====31%                    ] cutile_nsys.sqlite[2/8] [=====32%                    ] cutile_nsys.sqlite[2/8] [======33%                   ] cutile_nsys.sqlite[2/8] [======34%                   ] cutile_nsys.sqlite[2/8] [======35%                   ] cutile_nsys.sqlite[2/8] [=======36%                  ] cutile_nsys.sqlite[2/8] [=======37%                  ] cutile_nsys.sqlite[2/8] [=======38%                  ] cutile_nsys.sqlite[2/8] [=======39%                  ] cutile_nsys.sqlite[2/8] [========40%                 ] cutile_nsys.sqlite[2/8] [========41%                 ] cutile_nsys.sqlite[2/8] [========42%                 ] cutile_nsys.sqlite[2/8] [=========43%                ] cutile_nsys.sqlite[2/8] [=========44%                ] cutile_nsys.sqlite[2/8] [=========45%                ] cutile_nsys.sqlite[2/8] [=========46%                ] cutile_nsys.sqlite[2/8] [==========47%               ] cutile_nsys.sqlite[2/8] [==========48%               ] cutile_nsys.sqlite[2/8] [==========49%               ] cutile_nsys.sqlite[2/8] [===========50%              ] cutile_nsys.sqlite[2/8] [===========51%              ] cutile_nsys.sqlite[2/8] [===========52%              ] cutile_nsys.sqlite[2/8] [===========53%              ] cutile_nsys.sqlite[2/8] [============54%             ] cutile_nsys.sqlite[2/8] [============55%             ] cutile_nsys.sqlite[2/8] [============56%             ] cutile_nsys.sqlite[2/8] [============57%             ] cutile_nsys.sqlite[2/8] [=============58%            ] cutile_nsys.sqlite[2/8] [=============59%            ] cutile_nsys.sqlite[2/8] [=============60%            ] cutile_nsys.sqlite[2/8] [==============61%           ] cutile_nsys.sqlite[2/8] [==============62%           ] cutile_nsys.sqlite[2/8] [==============63%           ] cutile_nsys.sqlite[2/8] [==============64%           ] cutile_nsys.sqlite[2/8] [===============65%          ] cutile_nsys.sqlite[2/8] [===============66%          ] cutile_nsys.sqlite[2/8] [===============67%          ] cutile_nsys.sqlite[2/8] [================68%         ] cutile_nsys.sqlite[2/8] [================69%         ] cutile_nsys.sqlite[2/8] [================70%         ] cutile_nsys.sqlite[2/8] [================71%         ] cutile_nsys.sqlite[2/8] [=================72%        ] cutile_nsys.sqlite[2/8] [=================73%        ] cutile_nsys.sqlite[2/8] [=================74%        ] cutile_nsys.sqlite[2/8] [==================75%       ] cutile_nsys.sqlite[2/8] [==================76%       ] cutile_nsys.sqlite[2/8] [==================77%       ] cutile_nsys.sqlite[2/8] [==================78%       ] cutile_nsys.sqlite[2/8] [===================79%      ] cutile_nsys.sqlite[2/8] [===================80%      ] cutile_nsys.sqlite[2/8] [===================81%      ] cutile_nsys.sqlite[2/8] [===================82%      ] cutile_nsys.sqlite[2/8] [====================83%     ] cutile_nsys.sqlite[2/8] [====================84%     ] cutile_nsys.sqlite[2/8] [====================85%     ] cutile_nsys.sqlite[2/8] [=====================86%    ] cutile_nsys.sqlite[2/8] [=====================87%    ] cutile_nsys.sqlite[2/8] [=====================88%    ] cutile_nsys.sqlite[2/8] [=====================89%    ] cutile_nsys.sqlite[2/8] [======================90%   ] cutile_nsys.sqlite[2/8] [======================91%   ] cutile_nsys.sqlite[2/8] [======================92%   ] cutile_nsys.sqlite[2/8] [=======================93%  ] cutile_nsys.sqlite[2/8] [=======================94%  ] cutile_nsys.sqlite[2/8] [=======================95%  ] cutile_nsys.sqlite[2/8] [=======================96%  ] cutile_nsys.sqlite[2/8] [========================97% ] cutile_nsys.sqlite[2/8] [========================98% ] cutile_nsys.sqlite[2/8] [========================99% ] cutile_nsys.sqlite[2/8] [========================100%] cutile_nsys.sqlite[2/8] [========================100%] cutile_nsys.sqlite
[3/8] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)   Style                 Range               
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  -------  ----------------------------------
    100.0           53,424          1  53,424.0  53,424.0    53,424    53,424          0.0  PushPop  CCCL:cub::DeviceScan::InclusiveSum

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls     Avg (ns)         Med (ns)        Min (ns)       Max (ns)       StdDev (ns)             Name         
 --------  ---------------  ---------  ---------------  ---------------  -------------  -------------  ---------------  ----------------------
     27.2   11,464,135,872      1,964      5,837,136.4      4,649,680.0          1,168    885,619,952     26,594,214.2  poll                  
     23.4    9,889,395,472         68    145,432,286.4         17,776.0          1,232  9,851,736,080  1,194,630,747.5  futex                 
     23.4    9,858,816,640          1  9,858,816,640.0  9,858,816,640.0  9,858,816,640  9,858,816,640              0.0  pthread_join          
     23.3    9,845,683,056         11    895,062,096.0         33,360.0         12,608  9,844,196,336  2,968,092,055.5  epoll_wait            
      2.0      852,341,760          7    121,763,108.6     91,664,000.0     33,809,856    412,794,512    131,024,676.8  wait4                 
      0.6      243,603,360        467        521,634.6          9,888.0          1,152     14,842,800      1,425,859.5  ioctl                 
      0.0        8,900,064      1,276          6,975.0          2,496.0          1,008        161,984         14,733.1  read                  
      0.0        5,208,160      1,863          2,795.6          1,872.0          1,008         58,160          3,803.1  open64                
      0.0        5,144,144          7        734,877.7        639,024.0        420,720      1,378,080        313,575.4  posix_spawn           
      0.0        4,918,784         10        491,878.4        395,864.0         66,880      1,211,568        397,678.7  pthread_mutex_lock    
      0.0        2,855,184        588          4,855.8          1,344.0          1,008        503,328         26,329.9  mmap64                
      0.0        2,228,384        160         13,927.4          4,968.0          1,040        200,176         24,153.5  open                  
      0.0        1,785,120         24         74,380.0         57,264.0         22,992        186,016         50,347.2  pthread_create        
      0.0        1,460,512         68         21,478.1          5,048.0          1,424        220,560         36,033.6  write                 
      0.0        1,319,264        692          1,906.5          1,440.0          1,056         25,552          1,714.1  munmap                
      0.0          771,376         72         10,713.6          4,856.0          1,040         68,992         14,929.7  fopen                 
      0.0          707,024         94          7,521.5          4,000.0          1,216        156,624         16,789.8  fread                 
      0.0          684,832         93          7,363.8          5,936.0          1,024         38,224          6,282.6  mmap                  
      0.0          672,208          8         84,026.0         92,152.0         44,208        101,680         18,862.2  waitpid               
      0.0          615,072          8         76,884.0         53,456.0          3,152        267,888         81,367.3  fwrite                
      0.0          493,040          8         61,630.0         28,072.0         19,200        179,360         63,778.2  sem_timedwait         
      0.0          338,240         35          9,664.0          9,328.0          1,072         29,600          6,650.8  mprotect              
      0.0          337,520          1        337,520.0        337,520.0        337,520        337,520              0.0  posix_spawnp          
      0.0          188,288    SKIPPED: /home/hwoo_joo/github/cutileGPT/profiling_results/cutile_nsys.sqlite does not contain CUDA trace data.
SKIPPED: /home/hwoo_joo/github/cutileGPT/profiling_results/cutile_nsys.sqlite does not contain CUDA kernel data.
SKIPPED: /home/hwoo_joo/github/cutileGPT/profiling_results/cutile_nsys.sqlite does not contain GPU memory data.
SKIPPED: /home/hwoo_joo/github/cutileGPT/profiling_results/cutile_nsys.sqlite does not contain GPU memory data.
     39          4,827.9          3,392.0          1,008         25,200          5,366.2  fclose                
      0.0          108,544          1        108,544.0        108,544.0        108,544        108,544              0.0  pthread_cond_wait     
      0.0           97,904         24          4,079.3          2,480.0          1,616         10,368          2,646.9  pipe2                 
      0.0           54,368         10          5,436.8          3,744.0          1,840         18,624          5,325.7  fopen64               
      0.0           54,240         31          1,749.7          1,456.0          1,072          5,088            857.1  pthread_mutex_trylock 
      0.0           50,448          7          7,206.9          6,288.0          5,552         12,288          2,361.1  pread                 
      0.0           41,744          5          8,348.8          3,632.0          1,040         25,856         10,471.8  fgets                 
      0.0           20,368          6          3,394.7          3,784.0          1,648          4,912          1,188.7  pthread_cond_signal   
      0.0           17,728         10          1,772.8          1,544.0          1,040          3,888            852.1  dup2                  
      0.0           16,912         10          1,691.2          1,360.0          1,008          3,200            778.6  sigaction             
      0.0           16,368          2          8,184.0          8,184.0          4,192         12,176          5,645.5  socket                
      0.0           15,520          4          3,880.0          2,960.0          1,424          8,176          3,179.5  signal                
      0.0           14,544          6          2,424.0          1,696.0          1,296          4,960          1,428.8  flock                 
      0.0           12,112          1         12,112.0         12,112.0         12,112         12,112              0.0  socketpair            
      0.0           11,904          1         11,904.0         11,904.0         11,904         11,904              0.0  connect               
      0.0           10,672          3          3,557.3          3,440.0          2,912          4,320            711.3  epoll_ctl             
      0.0           10,432          5          2,086.4          1,824.0          1,104          3,856          1,150.5  fcntl                 
      0.0            8,480          4          2,120.0          1,408.0          1,168          4,496          1,588.9  pthread_cond_broadcast
      0.0            2,688          1          2,688.0          2,688.0          2,688          2,688              0.0  bind                  
      0.0            1,968          1          1,968.0          1,968.0          1,968          1,968              0.0  prctl                 

[5/8] Executing 'cuda_api_sum' stats report
[6/8] Executing 'cuda_gpu_kern_sum' stats report
[7/8] Executing 'cuda_gpu_mem_time_sum' stats report
[8/8] Executing 'cuda_gpu_mem_size_sum' stats report
Generated:
    /home/hwoo_joo/github/cutileGPT/profiling_results/cutile_nsys.nsys-rep
    /home/hwoo_joo/github/cutileGPT/profiling_results/cutile_nsys.sqlite

========================================
Profiling complete!
========================================

View results with:
  nsys-ui profiling_results/cutile_nsys.nsys-rep

Or generate report:
  nsys stats profiling_results/cutile_nsys.nsys-rep

